<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:media="http://search.yahoo.com/mrss/">
  <channel>
    <title>nodejs on log from home</title>
    <link>https://bemnlam.github.io/tags/nodejs/</link>
    <description>Recent content in nodejs on log from home</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy; bemnlam</copyright>
    <lastBuildDate>Sat, 27 Jun 2020 16:03:12 +0800</lastBuildDate>
    
	<atom:link href="https://bemnlam.github.io/tags/nodejs/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>üêû Battling With Gulp and Node</title>
      <link>https://bemnlam.github.io/posts/battling-with-gulp-and-node/</link>
      <pubDate>Sat, 27 Jun 2020 16:03:12 +0800</pubDate>
      
      <guid>https://bemnlam.github.io/posts/battling-with-gulp-and-node/</guid>
      
      
        <description>
          &lt;![CDATA[&lt;h2 id=&#34;-problem&#34;&gt;üò® Problem&lt;/h2&gt;
&lt;p&gt;When I was building a website using &lt;code&gt;gulp@^3.9.0&lt;/code&gt; to compile sass on the build server with Node.js v12 installed, it failed.&lt;/p&gt;
&lt;p&gt;Here are (part of) the errors shown in the console:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-systemverilog&#34; data-lang=&#34;systemverilog&#34;&gt;error	&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;Jun&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;08&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;35&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;02&lt;/span&gt;	gyp ERR&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt; node &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;v v12&lt;span style=&#34;color:#ae81ff&#34;&gt;.18.0&lt;/span&gt;
error	&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;Jun&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;08&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;35&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;02&lt;/span&gt;	gyp ERR&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt; node&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;gyp &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;v v3&lt;span style=&#34;color:#ae81ff&#34;&gt;.8.0&lt;/span&gt;
error	&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;Jun&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;08&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;35&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;02&lt;/span&gt;	gyp ERR&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;not&lt;/span&gt; ok 
error	&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;Jun&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;08&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;35&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;02&lt;/span&gt;	Build failed &lt;span style=&#34;color:#66d9ef&#34;&gt;with&lt;/span&gt; error code: &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
error	&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;Jun&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;08&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;35&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;05&lt;/span&gt;	
error	&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;Jun&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;08&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;35&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;05&lt;/span&gt;	npm ERR&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt; code ELIFECYCLE
error	&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;Jun&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;08&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;35&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;05&lt;/span&gt;	npm ERR&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt; errno &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
error	&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;Jun&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;08&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;35&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;05&lt;/span&gt;	npm ERR&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt; node&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;sass@&lt;span style=&#34;color:#ae81ff&#34;&gt;4.9.3&lt;/span&gt; postinstall: &lt;span style=&#34;color:#66d9ef&#34;&gt;`node&lt;/span&gt; scripts&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;build.js&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;`&lt;/span&gt;
error	&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;Jun&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;08&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;35&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;05&lt;/span&gt;	npm ERR&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt; Exit status &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
error	&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;Jun&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;08&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;35&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;05&lt;/span&gt;	npm ERR&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt; 
error	&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;Jun&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;08&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;35&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;05&lt;/span&gt;	npm ERR&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt; Failed at the node&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;sass@&lt;span style=&#34;color:#ae81ff&#34;&gt;4.9.3&lt;/span&gt; postinstall script.
error	&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;Jun&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;08&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;35&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;05&lt;/span&gt;	npm ERR&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt; This is probably &lt;span style=&#34;color:#66d9ef&#34;&gt;not&lt;/span&gt; a problem &lt;span style=&#34;color:#66d9ef&#34;&gt;with&lt;/span&gt; npm. There is likely additional logging &lt;span style=&#34;color:#66d9ef&#34;&gt;output&lt;/span&gt; above.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;(OK I know that&amp;rsquo;s not your fault, &lt;code&gt;npm&lt;/code&gt;.) Here is my &lt;code&gt;package.json&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;{
  &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;devDependencies&amp;#34;&lt;/span&gt;: {
    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;gulp&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;^3.9.0&amp;#34;&lt;/span&gt;,
    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;gulp-concat&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;^2.6.0&amp;#34;&lt;/span&gt;,
    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;gulp-minify-css&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;^1.2.4&amp;#34;&lt;/span&gt;,
    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;gulp-rename&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;^1.2.2&amp;#34;&lt;/span&gt;,
    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;gulp-sass&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;^4.0.2&amp;#34;&lt;/span&gt;,
    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;gulp-sourcemaps&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;*&amp;#34;&lt;/span&gt;
  }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;-node-sass&#34;&gt;üòê &lt;code&gt;node-sass&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;I noticed that should be something wrong with &lt;code&gt;node-sass&lt;/code&gt;, which being used in &lt;code&gt;gulp-sass&lt;/code&gt;. I met this issues before and from my experience, &lt;a href=&#34;https://stackoverflow.com/a/45807410/13742790&#34;&gt;&lt;code&gt;node-sass&lt;/code&gt; will try to download the corresponding prebuilt binary&lt;/a&gt; base on your OS or build it locally using &lt;code&gt;python&lt;/code&gt;, &lt;code&gt;MSBuild&lt;/code&gt;, etc&amp;hellip; (That&amp;rsquo;s why you will met lots of questions in Stack Overflow asking &lt;strong&gt;&lt;code&gt;python2&lt;/code&gt; not found when installing &lt;code&gt;node-sass&lt;/code&gt;&lt;/strong&gt; ,  &lt;strong&gt;what&amp;rsquo;s wrong with my &lt;code&gt;node-sass&lt;/code&gt;&lt;/strong&gt; or &lt;strong&gt;I got a panic attack when dealing with &lt;code&gt;node-sass&lt;/code&gt; should I consult a developer or a doctor first?&lt;/strong&gt;).&lt;/p&gt;
&lt;p&gt;For this &lt;code&gt;node-sass&lt;/code&gt; issue, &lt;a href=&#34;https://hisk.io/how-to-fix-node-js-gyp-err-cant-find-python-executable-python-on-windows/&#34;&gt;you can try to run this on Windows&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;npm install --global --production windows-build-tools
npm install node-gyp
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Or try to delete &lt;code&gt;package-lock.json&lt;/code&gt; and &lt;code&gt;node_modules&lt;/code&gt; first and do a &lt;code&gt;npm install&lt;/code&gt; if you can install all packages successfully on let say Mac OS but failed on Windows.&lt;/p&gt;
&lt;p&gt;üëÜThose tricks saved me most of the time.&lt;/p&gt;
&lt;h4 id=&#34;i-just-want-to-get-my-css-files-back-and-you-told-me-i-have-to-install-this-and-that-and-download-node-npm-python-ms-build-tools-some-prebuilt-binaries-are-you-serious-node-sass&#34;&gt;&lt;del&gt;I just want to get my css files back and you told me I have to install this and that and download node npm python ms build tools some prebuilt binaries? Are you serious, node-sass?&lt;/del&gt;&lt;/h4&gt;
&lt;h3 id=&#34;-referenceerror-primordials-is-not-defined&#34;&gt;üòë ReferenceError: primordials is not defined&lt;/h3&gt;
&lt;p&gt;After the &lt;code&gt;node-sass&lt;/code&gt; issue was solved, the build server ran the build jobs again and got these errors:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-systemverilog&#34; data-lang=&#34;systemverilog&#34;&gt;error	&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;Jun&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;08&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;53&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;06&lt;/span&gt;	fs.js:&lt;span style=&#34;color:#ae81ff&#34;&gt;35&lt;/span&gt;
error	&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;Jun&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;08&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;53&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;06&lt;/span&gt;	} &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; primordials;
error	&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;Jun&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;08&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;53&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;06&lt;/span&gt;	    &lt;span style=&#34;color:#f92672&#34;&gt;^&lt;/span&gt;
error	&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;Jun&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;08&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;53&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;06&lt;/span&gt;	
error	&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;Jun&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;08&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;53&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;06&lt;/span&gt;	ReferenceError: primordials is &lt;span style=&#34;color:#66d9ef&#34;&gt;not&lt;/span&gt; defined
error	&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;Jun&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;08&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;53&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;06&lt;/span&gt;	    at fs.js:&lt;span style=&#34;color:#ae81ff&#34;&gt;35&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;
## ( blah blah blah ) ##
error	&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;Jun&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;08&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;53&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;06&lt;/span&gt;	    at Module._compile (internal&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;modules&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;cjs&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;loader.js:&lt;span style=&#34;color:#ae81ff&#34;&gt;1138&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;30&lt;/span&gt;)
error	&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;Jun&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;08&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;53&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;06&lt;/span&gt;	    at Object.Module._extensions..js (internal&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;modules&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;cjs&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;loader.js:&lt;span style=&#34;color:#ae81ff&#34;&gt;1158&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;)
error	&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;Jun&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;08&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;53&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;06&lt;/span&gt;	    at Module.load (internal&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;modules&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;cjs&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;loader.js:&lt;span style=&#34;color:#ae81ff&#34;&gt;986&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;32&lt;/span&gt;)
error	&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;Jun&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;08&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;53&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;06&lt;/span&gt;	    at Function.Module._load (internal&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;modules&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;cjs&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;loader.js:&lt;span style=&#34;color:#ae81ff&#34;&gt;879&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;14&lt;/span&gt;)
error	&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;Jun&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;08&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;53&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;06&lt;/span&gt;	    at Module.require (internal&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;modules&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;cjs&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;loader.js:&lt;span style=&#34;color:#ae81ff&#34;&gt;1026&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;19&lt;/span&gt;)
error	&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;Jun&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2020&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;08&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;53&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;06&lt;/span&gt;	    at require (internal&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;modules&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;cjs&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;helpers.js:&lt;span style=&#34;color:#ae81ff&#34;&gt;72&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;18&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;https://stackoverflow.com/a/55926692/13742790&#34;&gt;This answer from Stack Overflow&lt;/a&gt; states that it is due to Node.js v12 does not compatible with Gulp v3 &lt;strong&gt;and you need to upgrade Gulp to v4&lt;/strong&gt;. I know &lt;strong&gt;I should&lt;/strong&gt; do that but I also know that I will meet the &lt;a href=&#34;https://github.com/sindresorhus/del/issues/45&#34;&gt;Did you forget to signal async completion?&lt;/a&gt; issue which also will cause an epic fail of the build &lt;strong&gt;unless I re-write the gulp tasks&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;I don&amp;rsquo;t want to change my &lt;code&gt;gulpfile.js&lt;/code&gt; and I don&amp;rsquo;t want to upgrade &lt;code&gt;gulp&lt;/code&gt;. Not now.  That&amp;rsquo;s why I started searching for a solution without changing any configurations of the build server as well as the gulp setup in the project.&lt;/p&gt;
&lt;h2 id=&#34;-solution-adding-a-npm-shrinkwrapjson&#34;&gt;üòÄ Solution: adding a &lt;code&gt;npm-shrinkwrap.json&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;Eventually I &lt;a href=&#34;https://stackoverflow.com/questions/55921442/how-to-fix-referenceerror-primordials-is-not-defined-in-node/58394828#58394828&#34;&gt;found a solution&lt;/a&gt; on how to handle this &amp;ldquo;Gulp VS Node&amp;rdquo; situation. What we need is create a &lt;code&gt;npm-shrinkwrap.json&lt;/code&gt; file under the same directory with &lt;code&gt;package.json&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The content of the json file:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;{
  &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;dependencies&amp;#34;&lt;/span&gt;: {
    &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;graceful-fs&amp;#34;&lt;/span&gt;: {
      &lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;version&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;4.2.3&amp;#34;&lt;/span&gt;
    }
  }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;After that I can build the project and finish all the gulp tasks without errors üéâ.&lt;/p&gt;
&lt;h3 id=&#34;-so-whats-going-on&#34;&gt;ü§î So, what&amp;rsquo;s going on?&lt;/h3&gt;
&lt;p&gt;From the npm&amp;rsquo;s official documentation on the &lt;a href=&#34;https://docs.npmjs.com/cli/shrinkwrap&#34;&gt;&lt;code&gt;npm-shrinkwrap&lt;/code&gt; command&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;This command repurposes package-lock.json into a publishable npm-shrinkwrap.json or simply creates a new one. The file created and updated by this command will then take precedence over any other existing or future package-lock.json files.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;And from the documentation on the &lt;a href=&#34;https://docs.npmjs.com/files/shrinkwrap.json&#34;&gt;&lt;code&gt;npm-shrinkwrap.json&lt;/code&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;hellip; Additionally, if both &lt;code&gt;package-lock.json&lt;/code&gt; and &lt;code&gt;npm-shrinkwrap.json&lt;/code&gt; are present in a package root, &lt;code&gt;package-lock.json&lt;/code&gt; will be ignored in favor of this file.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;In other words, this file has a &lt;em&gt;higher priority&lt;/em&gt; then &lt;code&gt;package-lock.json&lt;/code&gt;. However, why this file can solve the build error?&lt;/p&gt;
&lt;h4 id=&#34;thefs-module&#34;&gt;The&lt;code&gt;fs&lt;/code&gt; module&lt;/h4&gt;
&lt;p&gt;Node&amp;rsquo;s &lt;code&gt;fs&lt;/code&gt; module got some changes since &lt;strong&gt;v11.15&lt;/strong&gt; which cause the &lt;code&gt;graceful-fs@^3.0.0&lt;/code&gt; package does not work anymore. Unfortunately, &lt;code&gt;gulp@3.9.1&lt;/code&gt; depends on  &lt;code&gt;graceful-fs@^3.0.0&lt;/code&gt;. As a result, running the gulp tasks on Node.js v12 will cause the &lt;code&gt;primordials is not defined&lt;/code&gt; error.&lt;/p&gt;
&lt;h4 id=&#34;the-fix&#34;&gt;The fix&lt;/h4&gt;
&lt;p&gt;After we added the &lt;code&gt;npm-shrinkwrap.json&lt;/code&gt;, from my understanding it locked down the version of package(s) used by the execution environment to the version stated in that file (and ignore the setup in &lt;code&gt;package-lock.json&lt;/code&gt;.In the above case, the &lt;code&gt;npm-shrinkwrap.json&lt;/code&gt; tells Node.js 12 use &lt;code&gt;graceful-fs@4.2.3&lt;/code&gt; instead of &lt;code&gt;graceful-fs@^3.0.0&lt;/code&gt;. This combination works. Meanwhile, the &lt;code&gt;gulp&lt;/code&gt; package will still reference to the &lt;code&gt;package.json&lt;/code&gt; and &lt;code&gt;package-lock.json&lt;/code&gt; file and use the &lt;code&gt;graceful-fs@^3.0.0&lt;/code&gt; package. This combination also works.&lt;/p&gt;
&lt;h2 id=&#34;-conclusion&#34;&gt;üéØ Conclusion&lt;/h2&gt;
&lt;p&gt;I got some build errors when using &lt;code&gt;gulp@^3.9.0&lt;/code&gt; and &lt;code&gt;gulp-sass&lt;/code&gt; under Node.js 12. After I delete the &lt;code&gt;package-lock.json&lt;/code&gt; and  re-run &lt;code&gt;npm install&lt;/code&gt;, the sass problem solved. Next, I added a &lt;code&gt;npm-shrinkwrap.json&lt;/code&gt; to (temporarily) solve the incompatable issue with old gulp running on new Node.js.&lt;/p&gt;
&lt;h4 id=&#34;can-i-call-this-the-node-version-of-dependency-hell1&#34;&gt;&lt;del&gt;Can I call this the Node version of &lt;strong&gt;dependency hell&lt;/strong&gt;&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;?&lt;/del&gt;&lt;/h4&gt;
&lt;h6 id=&#34;-references&#34;&gt;üîó references:&lt;/h6&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://mejiblog.com/gulp-error/&#34;&gt;ReferenceError: primordials is not defined „ÅÆËß£Ê±∫ÊñπÊ≥ï„ÄêÂÇôÂøòÈå≤„Äë&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://mejiblog.com/gulpfile-change/&#34;&gt;Task function must be specified Ëß£Ê±∫ÊñπÊ≥ï„ÄêÂÇôÂøòÈå≤„Äë&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/mafintosh/prebuildify-ci/issues/5#issuecomment-550867124&#34;&gt;Node 12: Errors with &amp;lsquo;primordials is not defined&amp;rsquo; #5&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://blog.icetutor.com/how-to-fix-referenceerror-primordials-is-not-defined-error/&#34;&gt;How to fix ‚ÄúReferenceError: primordials is not defined‚Äù error&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;section class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;&lt;a href=&#34;https://en.m.wikipedia.org/wiki/Dependency_hell&#34;&gt;https://en.m.wikipedia.org/wiki/Dependency_hell&lt;/a&gt; &lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;
]]&gt;
        </description>
      
      
    </item>
    
  </channel>
</rss>
